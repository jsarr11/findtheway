<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Παίξε Prim</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/custom-level.css"> <!-- Link to the new CSS file -->
</head>
<body>
<header>
    <button onclick="window.location.href='/play-prim-en'">English</button>
</header>
<main>
    <h1>Παίξε Prim</h1>
    <div class="button-row">
        <button onclick="window.location.href='/theory-prim-el'">Θεωρία</button>
        <button onclick="window.location.href='/tutorial-prim-el'">Οδηγός</button>
    </div>
    <div class="button-row">
        <button onclick="playGame('beginner')">Αρχάριος</button>
        <button onclick="playGame('intermediate')">Μέτριος</button>
        <button onclick="playGame('expert')">Προχωρημένος</button>
    </div>
    <div class="button-container">
        <button onclick="showCustomLevelPopup()">Δημιουργία Προσαρμοσμένου Επιπέδου</button>
    </div>
    <div class="button-container">
        <button onclick="window.location.href='/play-el-back'">Πίσω</button>
    </div>
</main>

<!-- Custom Level Popup -->
<div id="customLevelPopup" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeCustomLevelPopup()">&times;</span>
        <h2>Δημιουργία Προσαρμοσμένου Επιπέδου</h2>
        <label for="vertices">Αριθμός Κορυφών:</label>
        <input type="number" id="vertices" name="vertices" min="5" max="25" required onchange="updateEdgeConstraints()"><br>
        <label for="edges">Αριθμός Ακμών:</label>
        <input type="number" id="edges" name="edges" min="3" required><br> <!-- Updated min value -->
        <label for="minWeight">Ελάχιστο Βάρος:</label>
        <input type="number" id="minWeight" name="minWeight" min="5" max="40" required><br>
        <label for="maxWeight">Μέγιστο Βάρος:</label>
        <input type="number" id="maxWeight" name="maxWeight" min="5" max="40" required><br>
        <button id="playButton" onclick="playCustomGame()" disabled>Παίξε</button>
        <div id="error-message" style="color: red; display: none;"></div>
    </div>
</div>

<script>
    function showCustomLevelPopup() {
        document.getElementById('customLevelPopup').style.display = 'block';
    }

    function closeCustomLevelPopup() {
        document.getElementById('customLevelPopup').style.display = 'none';
    }

    function updateEdgeConstraints() {
        const vertices = parseInt(document.getElementById('vertices').value);
        const maxEdges = (vertices * (vertices - 1)) / 2;
        document.getElementById('edges').min = vertices + 2; // Updated min value dynamically
        document.getElementById('edges').max = maxEdges;
        checkInputs();
    }

    function checkInputs() {
        const vertices = document.getElementById('vertices').value;
        const edges = document.getElementById('edges').value;
        const minWeight = document.getElementById('minWeight').value;
        const maxWeight = document.getElementById('maxWeight').value;

        if (vertices && edges && minWeight && maxWeight) {
            document.getElementById('playButton').disabled = false;
        } else {
            document.getElementById('playButton').disabled = true;
        }
    }

    function playGame(level) {
        window.location.href = `/main-game-prim-el?level=${level}`;
    }

    function playCustomGame() {
        const vertices = parseInt(document.getElementById('vertices').value);
        const edges = parseInt(document.getElementById('edges').value);
        const minWeight = parseInt(document.getElementById('minWeight').value);
        const maxWeight = parseInt(document.getElementById('maxWeight').value);

        const maxEdges = (vertices * (vertices - 1)) / 2;

        if (vertices < 5 || vertices > 25) {
            showErrorMessage("Μη έγκυρη είσοδος: Ο αριθμός των κορυφών πρέπει να είναι μεταξύ 5 και 25.");
            return;
        }
        if (edges < vertices + 2 || edges > maxEdges) {
            showErrorMessage(`Μη έγκυρη είσοδος: Ο αριθμός των ακμών πρέπει να είναι μεταξύ ${vertices + 2} και ${maxEdges} για ${vertices} κορυφές.`);
            return;
        }
        if (minWeight < 5 || minWeight > 40 || maxWeight < 5 || maxWeight > 40) {
            showErrorMessage("Μη έγκυρη είσοδος: Τα βάρη πρέπει να είναι μεταξύ 5 και 40.");
            return;
        }
        if (minWeight > maxWeight) {
            showErrorMessage("Μη έγκυρη είσοδος: Το ελάχιστο βάρος δεν μπορεί να είναι μεγαλύτερο από το μέγιστο βάρος.");
            return;
        }

        window.location.href = `/main-game-prim-el?level=custom&vertices=${vertices}&edges=${edges}&minWeight=${minWeight}&maxWeight=${maxWeight}`;
    }

    function showErrorMessage(message) {
        const errorMessageDiv = document.getElementById('error-message');
        errorMessageDiv.innerText = message;
        errorMessageDiv.style.display = 'block';
    }

    document.getElementById('vertices').addEventListener('input', checkInputs);
    document.getElementById('edges').addEventListener('input', checkInputs);
    document.getElementById('minWeight').addEventListener('input', checkInputs);
    document.getElementById('maxWeight').addEventListener('input', checkInputs);
</script>
</body>
</html>
